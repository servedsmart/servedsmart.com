<!doctype html>
<!--
--File = consent.html
--Author = Leopold Meinel (leo@meinel.dev)
-------
--Copyright (c) 2025 Leopold Meinel & contributors
--SPDX ID = MIT
--URL = https://opensource.org/licenses/MIT
-------
 -->
{{- $style := resources.Get "css/consent.css" | minify | fingerprint -}}
<link rel="stylesheet" href="{{- $style.Permalink -}}" />

<div id="consent-notice-container" class="active">
  <div id="consent-notice" class="active">
    <span
      >{{- T "consent-text-start" -}}<a
        class="manage-consent"
        href="#manage-consent"
        >{{- T "consent-text-href" -}}</a
      >{{- T "consent-text-end" -}}</span
    ><br />
    <button class="btn manage-consent">
      {{- T "consent-button-manage-consent" -}}</button
    ><button class="btn deny-consent">
      {{- T "consent-button-deny-consent" -}}</button
    ><button class="btn approve-consent">
      {{- T "consent-button-approve-consent" -}}
    </button>
  </div>
</div>
<div id="consent-overlay-container">
  <div id="consent-overlay">
    <div>
      {{- $currentLang := $.Site.Language.Lang -}} {{- $data := index
      $.Site.Data $currentLang "consent" "items" -}} {{- range $index, $item :=
      $data -}}
      <div>
        <label class="form-control">
          <input
            type="checkbox"
            id="item{{- $index -}}"
            value="1"
            name="item{{- $index -}}"
            {{
            if
            $item.is_functional
            }}checked
            disabled{{end}}
          />
        </label>
        <label for="item{{- $index -}}"
          ><header><h3>{{- $item.title -}}</h3></header>
          <main><p>{{- $item.description -}}</p></main>
        </label>
      </div>
      {{- end -}}
      <div>
        <button
          id="save-consent"
          class="btn save-consent"
          data-consentvalue="{{ $currentLang := $.Site.Language.Lang }}{{ $data := index $.Site.Data $currentLang `consent` `items` }}{{ range $data }}{{ if .is_functional}}{{ else }}0{{ end }}{{ end }}"
        >
          {{- T "consent-button-save-consent" -}}</button
        ><button class="btn approve-consent">
          {{- T "consent-button-approve-consent" -}}
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  const optionalScripts = [];
  {{- $currentLang := $.Site.Language.Lang -}} {{- $data := index $.Site.Data $currentLang "consent" "items" -}} {{- range $index, $item := where $data "is_functional" "eq" false -}} {{- $script_file := resources.Get (printf "js/" $item.script_file) | minify | fingerprint -}}
  optionalScripts[{{- $index -}}] = "{- $script_file.RelPermalink -}}"; {{- end -}}
  const functionalScripts = [];
  {{- $currentLang := $.Site.Language.Lang -}} {{- $data := index $.Site.Data $currentLang "consent" "items" -}} {{- range $index, $item := where $data "is_functional" "eq" true -}} {{- $script_file := resources.Get (printf "js/" $item.script_file) | minify | fingerprint -}}
  functionalScripts[{{- $index -}}] = "{{- $script_file.RelPermalink -}}"; {{- end -}}
</script>
{{- $consent := resources.Get "js/consent.js" | minify | fingerprint -}}
<script src="{{- $consent.RelPermalink -}}"></script>
